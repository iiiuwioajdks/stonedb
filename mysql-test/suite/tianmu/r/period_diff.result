#
# Test of PERIOD_DIFF function
#
DROP DATABASE IF EXISTS period_diff_test;
CREATE DATABASE period_diff_test;
USE period_diff_test;
SELECT PERIOD_DIFF(201808,199508);
PERIOD_DIFF(201808,199508)
276
SELECT PERIOD_DIFF(1601,1603);
PERIOD_DIFF(1601,1603)
-2
SELECT PERIOD_DIFF(191602,191607);
PERIOD_DIFF(191602,191607)
-5
SELECT PERIOD_DIFF(1916-02,1916-07);
PERIOD_DIFF(1916-02,1916-07)
5
SELECT PERIOD_DIFF(1602,9002);
PERIOD_DIFF(1602,9002)
312
CREATE TABLE t1 (a DECIMAL(10,1));
INSERT INTO t1 VALUES (200101.9);
SELECT a,PERIOD_DIFF(a, 200101) FROM t1;
a	PERIOD_DIFF(a, 200101)
200101.9	1
DROP TABLE t1;
# Wide decimal rounding
CREATE TABLE t1 (a DECIMAL(17,1));
INSERT INTO t1 VALUES (200101.9);
SELECT a,PERIOD_DIFF(a, 200101) FROM t1;
a	PERIOD_DIFF(a, 200101)
200101.9	1
DROP TABLE t1;
# Huge narrow decimal
# Huge wide decimal
# Huge double
CREATE TABLE t1 (a DOUBLE);
INSERT INTO t1 VALUES (9223372036854775807.0-1000);
INSERT INTO t1 VALUES (9223372036854775807.0+1000);
SELECT a, PERIOD_DIFF(200101,a) FROM t1 ORDER BY 2;
a	PERIOD_DIFF(200101,a)
9.223372036854776e18	-1106804644422549090
9.223372036854775e18	-1106804644422549035
DROP TABLE t1;
DROP DATABASE period_diff_test;
